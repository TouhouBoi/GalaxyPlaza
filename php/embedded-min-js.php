<?php header('Content-Type: application/javascript'); ?>var Miiverse=Miiverse||{uri:"<?=htmlspecialchars($_SERVER['HTTP_HOST'])?>"};!function(e){function t(t){var i=document.createElement("a");i.href=t;var s,r=i.hostname,a=i.pathname,n=a.match(/^\/?posts\/([0-9A-Za-z\-_]+)$/);return n&&n[1]&&(s=n[1]),{host:r,path:a,postId:s,isMine:r===e.uri}}function i(e){if(t(e.origin).isMine){for(var i,s={},r=e.data.split(/\s*,\s*/),a=0;i=r[a];a++){var n=i.split(/\s*:\s*/);n[0]&&n[1]&&(s[n[0]]=n[1])}var o=s.height;if(o&&isFinite(o))for(var d,l=document.getElementsByTagName("iframe"),a=0;d=l[a];a++)if(e.source==d.contentWindow){d.scrolling="no",d.style.height=o+"px";break}}}e.Post||(e.Post={tryCreate:function(i){var s=i.getAttribute("data-miiverse-cite"),r=t(s);r.isMine&&r.postId&&e.Post.replaceElement(i,r.postId,s+"/embed")},setup:function(){for(var t,i=document.querySelectorAll?document.querySelectorAll("div.miiverse-post"):document.getElementsByTagName("div"),s=[],r=/(?:^|\s)miiverse-post(?:\s|$)/,a=0;t=i[a];a++)r.test(t.className)&&s.push(t);for(var n,o=0;n=s[o];o++)e.Post.tryCreate(n)},replaceElement:function(e,t,i){var s=document.createElement("iframe");s.className="miiverse-post-frame miiverse-post-"+t,s.src=i,s.style.display="block",s.style.minWidth="220px",s.style.maxWidth="500px",s.style.width="98%",s.style.padding="0px",s.style.borderRadius="5px",s.style.margin="10px 0px",s.style.border="1px solid #dddddd",s.style.boxShadow="0px 1px 3px rgba(0, 0, 0, 0.3)",s.style.position="static",s.style.visibility="visible",e.parentNode.replaceChild(s,e)}},window.addEventListener?window.addEventListener("message",i,!1):window.attachEvent&&window.attachEvent("onmessage",i))}(Miiverse),Miiverse.Post.setup();